{% extends "layout.html" %}
{% block title %}Start{% endblock %}
{% block content %}
  <script>
  function toggleSkip() {
      let modal = document.getElementById('skipModal');
      modal.style.display = modal.style.display === "block" ? "none" : "block";
  }
  function toggleReport() {
      let modal = document.getElementById('reportModal');
      modal.style.display = modal.style.display === "block" ? "none" : "block";
  }
  function topSkip() {
      const skip = document.getElementById('modalSkipButton');
      let top = document.getElementById('skipRadioTop');
      let bottom = document.getElementById('skipRadioBottom');
      let button = document.getElementById('modalSkipButton');
      let buttonText = document.getElementById('modalSkipText');
      buttonText.classList = ['modal-button-text modal-skip-text-active'];
      button.type = 'submit';
      button.classList = ['modal-next-button-button skip-active'];
      top.classList = ['skipRadio skipActive'];
      bottom.classList = ['skipRadio'];
      skip.value = 'SkipAbsent';
    }
    function bottomSkip() {
      const skip = document.getElementById('modalSkipButton');
      let top = document.getElementById('skipRadioTop');
      let bottom = document.getElementById('skipRadioBottom');
      let button = document.getElementById('modalSkipButton');
      let buttonText = document.getElementById('modalSkipText');
      buttonText.classList = ['modal-button-text modal-skip-text-active'];
      button.type = 'submit';
      button.classList = ['modal-next-button-button skip-active'];
      bottom.classList = ['skipRadio skipActive'];
      top.classList = ['skipRadio'];
      skip.value = 'SkipBusy';
    }
    function setChecks() {
      let checks = document.forms['checkboxForm'].elements['checkbox[]'];
      let button = document.getElementById('modalReportButton');
      let buttonText = document.getElementById('modalReportText');
      buttonText.classList = ['modal-button-text modal-report-text-active'];
      let vals = "";
      let checkedCount = 0;
      for(let i = 0; i < checks.length; i++) {
        if (checks[i].checked) {
          vals += checks[i].value + " ";
          checks[i].classList = ['reportCheck reportActive'];
          checkedCount++;
        } else {
          checks[i].classList = ['reportCheck'];
        }
      }

      if(checkedCount === 0) {
        button.classList = ['modal-next-button-button'];
        button.type = 'button';
      } else {
        button.classList = ['modal-next-button-button report-active'];
        button.type = 'submit';
      }

      button.value = vals.trim();
    }

    $(document).ready(function() {
    $('.report-table tr').click(function(event) {
    if (event.target.type !== 'checkbox') {
      $(':checkbox', this).trigger('click');
      }
    });
  });
  </script>
  <style type="text/css">
table {
  border: 0;
}
  tr {
    border: 0;
  }
  td {
    border: 0;
  }
</style>
  <div class="item">
    <div class="projectInfo">
      <h2 class="projectScreenTitle">Visit the following project to get started.</h2>
      <p class="voteItemTeam" style="color: black; padding-bottom: 8px;">CURRENT PROJECT</p>
      <div class="item projectItem">
        {% with item=item %}
          {% include "_item.html" %}
        {% endwith %}
      </div>
      {#      <form action="/begin" method="post">
        <input type="submit" name="action" value="Skip" id="vote-skip" class="button-full">
        <input type="submit" name="action" value="Done" id="vote-done" class="button-full button-gap">
        <input type="hidden" name="item_id" value="{{ item.id }}">
        <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
      </form>#}
    </div>
  </div>

  <div class="modal" id="skipModal">
    <div class="modal-content">
      <div class="modal-content-projects-container">
        <h2 class="skipTitle" style="padding-bottom: 0; margin-bottom: 16px;">I need to skip the <span class="skipTitlePurple">current project</span> because:</h2>
        <table style="width: 100%" class="borderless" rules="none">
          <tr onclick="topSkip()">
            <td>
              <div class="skipRadio" id="skipRadioTop" onclick="topSkip()"></div>
            </td>
            <td class="skipText">They are not present for judging</td>
          </tr>
          <tr style="height: 16px;"></tr>
          <tr onclick="bottomSkip()">
            <td>
              <div class="skipRadio" id="skipRadioBottom" onclick="bottomSkip()"></div>
            </td>
            <td class="skipText">They are currently occupied with presenting to another judge.</td>
          </tr>
        </table>
      </div>

      <div class="modal-close">
        <span class="modal-button-text" id="skipCloseButton" style="height: 100%; margin-top: 0; padding-top: 24px;" onclick="toggleSkip()">CLOSE</span>
      </div>

      <div class="modal-next">
        <form action="/begin" method="post" class="submit-form">
          <button id="modalSkipButton" class="modal-next-button-button" name="action" type="button" value="Skip"
                  style="background: 0; border: 0;"><a class="modal-button-text" id="modalSkipText" style="margin: 0;">CONFIRM SKIP</a></button>
          <input type="hidden" name="item_id" value="{{ item.id }}">
          <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
        </form>
      </div>
    </div>
  </div>

  <div class="modal" id="reportModal">
    <div class="modal-content">
      <div class="modal-content-projects-container">
        <h2 class="skipTitle" style="padding-bottom: 0; margin-bottom: 16px;">The <span class="skipTitlePurple">current project</span> needs to be reviewed for the following reasons:</h2>
        <form id="checkboxForm">
        <table style="width: 100%" class="borderless report-table" rules="none">
          <tr>
            <td>
              <input type="checkbox" class="reportCheck" id="reportCheckOne" value="NoDemo" name="checkbox[]" onclick="setChecks()"/>
            </td>
            <td>
              <label for=reportCheckOne class="skipText">The team cannot demo their project or provide evidence of the work described.</label>
            </td>
          </tr>
          <tr style="height: 16px;"></tr>
          <tr>
            <td>
              <input type="checkbox" class="reportCheck" id="reportCheckTwo" value="TooComplex" name="checkbox[]" onclick="setChecks()"/>
            </td>
            <td>
              <label for="reportCheckTwo" class="skipText">The project appears too complex to have been created within the prescribed timeframe of the hackathon.</label>
            </td>
          </tr>
          <tr style="height: 16px;"></tr>
          <tr>
            <td>
              <input type="checkbox" class="reportCheck" id="reportCheckThree" value="Offensive" name="checkbox[]" onclick="setChecks()"/>
            </td>
            <td>
              <label for="reportCheckThree" class="skipText">The project is or has offensive, harrassing, or inappropriate content and/or breaks the Code of Conduct and Ethics.</label>
            </td>
          </tr>
        </table>
        </form>
      </div>

      <div class="modal-close">
        <span class="modal-button-text" id="skipCloseButton" style="height: 100%; margin-top: 0; padding-top: 24px;" onclick="toggleReport()">CLOSE</span>
      </div>

      <div class="modal-next">
        <form action="/report" method="post" class="submit-form">
          <button id="modalReportButton" class="modal-next-button-button" name="reason" type="button" value="Unknown"
                  style="background: 0; border: 0;"><a class="modal-button-text" id="modalReportText" style="margin: 0;">SUBMIT FOR REVIEW</a></button>
          <input type="hidden" name="next_id" value="{{ item.id }}">
          <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
        </form>
      </div>

    </div>
  </div>

  <div class="bottomPanel">
    <form action="/begin" method="post">
      <button class="flagButton" type="button" onclick="toggleReport()"></button>
      <button class="skipButton" type="button" onclick="toggleSkip()"></button>
      <button class="doneButton doneButtonText" type="submit" name="action" value="Done">Done With Visit</button>
      <input type="hidden" name="item_id" value="{{ item.id }}">
      <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
    </form>
  </div>
{% endblock %}
